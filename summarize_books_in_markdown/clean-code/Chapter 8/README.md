# π­ Chapter 8: κ²½κ³„

## πƒ μ™Έλ¶€ μ½”λ“ μ‚¬μ©ν•κΈ°
ν¨ν‚¤μ§€ μ κ³µμλ‚ ν”„λ μ„μ›ν¬ μ κ³µμλ” μ μ©μ„±μ„ μµλ€ν• λ„“νλ ¤ μ• μ“΄λ‹¤. λ” λ§μ€ ν™κ²½μ—μ„ λμ•„κ°€μ•Ό λ” λ§μ€ κ³ κ°μ΄ κµ¬λ§¤ν•λ‹κΉ. λ°λ©΄, μ‚¬μ©μλ” μμ‹ μ μ”κµ¬μ— μ§‘μ¤‘ν•λ” μΈν„°νμ΄μ¤λ¥Ό λ°”λ€λ‹¤. μ΄λ° κΈ΄μ¥μΌλ΅ μΈν•΄ μ‹μ¤ν… κ²½κ³„μ—μ„ λ¬Έμ κ°€ μƒκΈΈ μ†μ§€κ°€ λ§λ‹¤.   

ν• μλ΅, `java.util.Map`μ„ μ‚΄ν΄λ³΄μ. `Map`μ€ κµ‰μ¥ν λ‹¤μ–‘ν• μΈν„°νμ΄μ¤λ΅ μλ§μ€ κΈ°λ¥μ„ μ κ³µν•λ‹¤. `Map`μ΄ μ κ³µν•λ” κΈ°λ¥μ„±κ³Ό μ μ—°μ„±μ€ ν™•μ‹¤ν μ μ©ν•μ§€λ§ κ·Έλ§νΌ μ„ν—λ„ ν¬λ‹¤.   

```java
Map sensors = new HashMap();
```

`Sensor` κ°μ²΄κ°€ ν•„μ”ν• μ½”λ“λ” λ‹¤μκ³Ό κ°™μ΄ `Sensor` κ°μ²΄λ¥Ό κ°€μ Έμ¨λ‹¤.

```java
Sensor s = (Sensor)sensors.get(sensorId);
```

μ„μ™€ κ°™μ€ μ½”λ“κ°€ ν• λ²μ΄ μ•„λ‹λΌ μ—¬λ¬ μ°¨λ΅€ λ‚μ¨λ‹¤. μ¦‰, `Map`μ΄ λ°ν™ν•λ” `Object`λ¥Ό μ¬λ°”λ¥Έ μ ν•μΌλ΅ λ³€ν™ν•  μ±…μ„μ€ `Map`μ„ μ‚¬μ©ν•λ” ν΄λΌμ΄μ–ΈνΈμ— μλ‹¤. κ·Έλλ„ μ½”λ“λ” λ™μ‘ν•λ‹¤. ν•μ§€λ§ κΉ¨λ—ν• μ½”λ“λΌ λ³΄κΈ°λ” μ–΄λ µλ‹¤. κ²λ‹¤κ°€ μ„μ™€ κ°™μ€ μ½”λ“λ” μλ„λ„ λ¶„λ…ν λ“λ¬λ‚μ§€ μ•λ”λ‹¤. λ€μ‹  λ‹¤μκ³Ό κ°™μ΄ μ λ„¤λ¦­μ¤λ¥Ό μ‚¬μ©ν•λ©΄ μ½”λ“ κ°€λ…μ„±μ΄ ν¬κ² λ†’μ•„μ§„λ‹¤.

```java
Map<String, Sensor> sensors = new HashMap<Sensor>();
// ...
Sensor s = sensors.get(sensorId);
```

κ·Έλ ‡μ§€λ§ μ„ λ°©λ²•λ„ `Map<String, Sensor>`κ°€ μ‚¬μ©μμ—κ² ν•„μ”ν•μ§€ μ•μ€ κΈ°λ¥κΉμ§€ μ κ³µν•λ‹¤λ” λ¬Έμ λ” ν•΄κ²°ν•μ§€ λ»ν•λ‹¤.   

λ‹¤μμ€ `Map`μ„ μΆ€ λ” κΉ”λ”ν•κ² μ‚¬μ©ν• μ½”λ“λ‹¤. `Sensors` μ‚¬μ©μλ” μ λ„¤λ¦­μ¤κ°€ μ‚¬μ©λμ—λ”μ§€ μ—¬λ¶€μ— μ‹ κ²½ μ“Έ ν•„μ”κ°€ μ—†λ‹¤. μ•„λμ—μ„ λ³΄λ“―, μ λ„¤λ¦­μ¤μ μ‚¬μ© μ—¬λ¶€λ” `Sensors` μ•μ—μ„ κ²°μ •ν•λ‹¤.

```java
public class Sensors {
  private Map sensors = new HashMap();

  public Sensor getById(String id) {
    return (Sensor) sensors.get(id);
  }

  // μ΄ν• μƒλµ
}
```

κ²½κ³„ μΈν„°νμ΄μ¤μΈ `Map`μ„ `Sensors` μ•μΌλ΅ μ¨κΈ΄λ‹¤. λ”°λΌμ„ `Map` μΈν„°νμ΄μ¤κ°€ λ³€ν•λ”λΌλ„ λ‚λ¨Έμ§€ ν”„λ΅κ·Έλ¨μ—λ” μν–¥μ„ λ―ΈμΉμ§€ μ•λ”λ‹¤. μ λ„¤λ¦­μ¤λ¥Ό μ‚¬μ©ν•λ” ν•μ§€ μ•λ“  λ” μ΄μƒ λ¬Έμ κ°€ μ• λλ‹¤. `Sensors` ν΄λμ¤ μ•μ—μ„ κ°μ²΄ μ ν•μ„ κ΄€λ¦¬ν•κ³  λ³€ν™ν•κΈ° λ•λ¬Έμ΄λ‹¤.   

λν• `Sensors` ν΄λμ¤λ” ν”„λ΅κ·Έλ¨μ— ν•„μ”ν• μΈν„°νμ΄μ¤λ§ μ κ³µν•λ‹¤. κ·Έλμ„ μ½”λ“λ” μ΄ν•΄ν•κΈ°λ” μ‰½μ§€λ§ μ¤μ©ν•κΈ°λ” μ–΄λ µλ‹¤. `Sensors` ν΄λμ¤λ” (λ‚λ¨Έμ§€ ν”„λ΅κ·Έλ¨μ΄) μ„¤κ³„ κ·μΉ™κ³Ό λΉ„μ¦λ‹μ¤ κ·μΉ™μ„ λ”°λ¥΄λ„λ΅ κ°•μ ν•  μ μλ‹¤.   

`Map` ν΄λμ¤λ¥Ό μ‚¬μ©ν•  λ•λ§λ‹¤ μ„μ™€ κ°™μ΄ μΊ΅μν™”ν•λΌλ” μ†λ¦¬κ°€ μ•„λ‹λ‹¤. `Map`μ„ μ—¬κΈ°μ €κΈ° λ„κΈ°μ§€ λ§λΌλ” λ§μ΄λ‹¤. `Map`κ³Ό κ°™μ€ κ²½κ³„ μΈν„°νμ΄μ¤λ¥Ό μ΄μ©ν•  λ•λ” μ΄λ¥Ό μ΄μ©ν•λ” ν΄λμ¤λ‚ ν΄λμ¤ κ³„μ—΄ λ°–μΌλ΅ λ…Έμ¶λμ§€ μ•λ„λ΅ μ£Όμν•λ‹¤.

## πƒ κ²½κ³„ μ‚΄ν”Όκ³  μµνκΈ°
μ™Έλ¶€ ν¨ν‚¤μ§€ ν…μ¤νΈκ°€ μ°λ¦¬ μ±…μ„μ€ μ•„λ‹λ‹¤. ν•μ§€λ§ μ°λ¦¬ μμ‹ μ„ μ„ν•΄ μ°λ¦¬κ°€ μ‚¬μ©ν•  μ½”λ“λ¥Ό ν…μ¤νΈν•λ” νΈμ΄ λ°”λμ§ν•λ‹¤.   

μ™Έλ¶€ μ½”λ“λ¥Ό μµνκΈ°λ” μ–΄λ µλ‹¤. μ™Έλ¶€ μ½”λ“λ¥Ό ν†µν•©ν•κΈ°λ„ μ–΄λ µλ‹¤. κ³§λ°”λ΅ μ°λ¦¬μ½ μ½”λ“λ¥Ό μ‘μ„±ν•΄ μ™Έλ¶€ μ½”λ“λ¥Ό νΈμ¶ν•λ” λ€μ‹  λ¨Όμ € κ°„λ‹¨ν• ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό μ‘μ„±ν•΄ μ™Έλ¶€ μ½”λ“λ¥Ό μµνλ©΄ μ–΄λ–¨κΉ? μ  λ‰΄μ»¤ν¬λ” μ΄λ¥Ό **ν•™μµ ν…μ¤νΈ**λΌ λ¶€λ¥Έλ‹¤.   

ν•™μµ ν…μ¤νΈλ” ν”„λ΅κ·Έλ¨μ—μ„ μ‚¬μ©ν•λ ¤λ” λ°©μ‹λ€λ΅ μ™Έλ¶€ APIλ¥Ό νΈμ¶ν•λ‹¤. ν†µμ λ ν™κ²½μ—μ„ APIλ¥Ό μ λ€λ΅ μ΄ν•΄ν•λ”μ§€λ¥Ό ν™•μΈν•λ” μ…μ΄λ‹¤. ν•™μµ ν…μ¤νΈλ” APIλ¥Ό μ‚¬μ©ν•λ ¤λ” λ©μ μ— μ΄μ μ„ λ§μ¶λ‹¤.

## πƒ log4jμµνκΈ°
λ΅κΉ… κΈ°λ¥μ„ μ§μ ‘ κµ¬ν„ν•λ” λ€μ‹  μ•„νμΉμ `log4j` ν¨ν‚¤μ§€λ¥Ό μ‚¬μ©ν•λ ¤ ν•λ‹¤κ³  κ°€μ •ν•μ. λ¬Έμ„λ¥Ό μμ„Έν μ½κΈ° μ „μ— μ²« λ²μ§Έ ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό μ‘μ„±ν•λ‹¤. ν™”λ©΄μ— `hello`λ¥Ό μ¶λ ¥ν•λ” ν…μ¤νΈ μΌ€μ΄μ¤λ‹¤.

```java
@Test
public void testLogCreate() {
  Logger logger = Logger.getLogger("MyLogger");
  logger.info("hello");
}
```

ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό λλ Έλ”λ‹ `Appender`λΌλ” λ­”κ°€κ°€ ν•„μ”ν•λ‹¤λ” μ¤λ¥κ°€ λ°μƒν•λ‹¤. λ¬Έμ„λ¥Ό μΆ€ λ” μ½μ–΄λ³΄λ‹ `ConsoleAppender`λΌλ” ν΄λμ¤κ°€ μλ‹¤. κ·Έλμ„ `ConsoleAppender`λ¥Ό μƒμ„±ν• ν›„ ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό λ‹¤μ‹ λλ¦°λ‹¤.

```java
@Test
public void testLogAddAppender() {
  Logger logger = Logger.getLogger("MyLogger");
  ConsoleAppender appender = new ConsoleAppender();
  logger.addAppender(appender);
  logger.info("hello");
}
```

μ΄λ²μ—λ” `Appender`μ— μ¶λ ¥ μ¤νΈλ¦Όμ΄ μ—†λ‹¤λ” μ‚¬μ‹¤μ„ λ°κ²¬ν•λ‹¤. μ΄μƒν•λ‹¤. μ¶λ ¥ μ¤νΈλ¦Όμ΄ μμ–΄μ•Ό μ •μƒμ΄ μ•„λ‹κ°€? κµ¬κΈ€μ—μ„ κ²€μƒ‰ν• ν›„ λ‹¤μκ³Ό κ°™μ΄ μ‹λ„ν•λ‹¤.

```java
@Test
public void testLogAddAppender() {
  Logger logger = Logger.getLogger("MyLogger");
  logger.removeAllAppenders();
  logger.addAppender(new ConsoleAppender(
    new PatternLayout("%p %t %m%n"),
    ConsoleAppender.SYSTEM_OUT
  ));
  logger.info("hello");
}
```

μ΄μ μ„μ•Ό μ λ€λ΅ λμ•„κ°„λ‹¤. μ§€κΈκΉμ§€ κ°„λ‹¨ν• μ½μ†” λ΅κ±° μ΄κΈ°ν™”ν•λ” λ°©λ²•μ„ μµν”μΌλ‹, μ΄μ  λ¨λ“  μ§€μ‹μ„ λ…μμ μΈ λ΅κ±° ν΄λμ¤λ΅ μΊ΅μν™”ν•λ‹¤. κ·Έλ¬λ©΄ λ‚λ¨Έμ§€ ν”„λ΅κ·Έλ¨μ€ `log4j` κ²½κ³„ μΈν„°νμ΄μ¤λ¥Ό λ°λΌλ„ λλ‹¤.

## πƒ ν•™μµ ν…μ¤νΈλ” κ³µμ§ μ΄μƒμ΄λ‹¤.
ν•™μµ ν…μ¤νΈλ” κ³µμ§ μ΄μƒμ΄λ‹¤. ν¬μν•λ” λ…Έλ ¥λ³΄λ‹¤ μ–»λ” μ„±κ³Όκ°€ λ” ν¬λ‹¤. ν¨ν‚¤μ§€ μƒ λ²„μ „μ΄ λ‚μ¨λ‹¤λ©΄ ν•™μµ ν…μ¤νΈλ¥Ό λλ ¤ μ°¨μ΄κ°€ μλ”μ§€ ν™•μΈν•λ‹¤. ν•™μµ ν…μ¤νΈλ” ν¨ν‚¤μ§€κ°€ μμƒλ€λ΅ λ„λ”μ§€ κ²€μ¦ν•λ‹¤. μΌλ‹¨ ν†µν•©ν• μ΄ν›„λΌκ³  ν•λ”λΌλ„ ν¨ν‚¤μ§€κ°€ μ°λ¦¬ μ½”λ“μ™€ νΈν™λλ¦¬λΌλ” λ³΄μ¥μ€ μ—†λ‹¤. ν¨ν‚¤μ§€ μ‘μ„±μμ—κ² μ½”λ“λ¥Ό λ³€κ²½ν•  ν•„μ”κ°€ μƒκΈΈμ§€λ„ λ¨λ¥Έλ‹¤. ν¨ν‚¤μ§€ μ‘μ„±μλ” λ²„κ·Έλ¥Ό μμ •ν•κ³  κΈ°λ¥λ„ μ¶”κ°€ν•λ‹¤. ν¨ν‚¤μ§€ μƒ λ²„μ „μ΄ λ‚μ¬ λ•λ§λ‹¤ μƒλ΅μ΄ μ„ν—μ΄ μƒκΈ΄λ‹¤. μƒ λ²„μ „μ΄ μ°λ¦¬ μ½”λ“μ™€ νΈν™λμ§€ μ•μΌλ©΄ ν•™μµ ν…μ¤νΈκ°€ μ΄ μ‚¬μ‹¤μ„ κ³§λ°”λ΅ λ°ν€λ‚Έλ‹¤.   

ν•™μµ ν…μ¤νΈλ¥Ό μ΄μ©ν• ν•™μµμ΄ ν•„μ”ν•λ“  κ·Έλ ‡μ§€ μ•λ“ , μ‹¤μ  μ½”λ“μ™€ λ™μΌν• λ°©μ‹μΌλ΅ μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” ν…μ¤νΈ μΌ€μ΄μ¤κ°€ ν•„μ”ν•λ‹¤. μ΄λ° κ²½κ³„ ν…μ¤νΈκ°€ μλ‹¤λ©΄ ν¨ν‚¤μ§€μ μƒ λ²„μ „μΌλ΅ μ΄μ „ν•κΈ° μ‰¬μ›μ§„λ‹¤. κ·Έλ ‡μ§€ μ•λ‹¤λ©΄ λ‚΅μ€ λ²„μ „μ„ ν•„μ” μ΄μƒμΌλ΅ μ¤λ«λ™μ• μ‚¬μ©ν•λ ¤λ” μ νΉμ— λΉ μ§€κΈ° μ‰½λ‹¤.

## πƒ μ•„μ§ μ΅΄μ¬ν•μ§€ μ•μ€ μ½”λ“λ¥Ό μ‚¬μ©ν•κΈ°
κ²½κ³„μ™€ κ΄€λ ¨ν•΄ λ λ‹¤λ¥Έ μ ν•μ€ μ•„λ” μ½”λ“μ™€ λ¨λ¥΄λ” μ½”λ“λ¥Ό λ¶„λ¦¬ν•λ” κ²½κ³„λ‹¤. λ•λ΅λ” μ°λ¦¬ μ§€μ‹μ΄ κ²½κ³„λ¥Ό λ„μ–΄ λ―ΈμΉμ§€ λ»ν•λ” μ½”λ“ μμ—­λ„ μλ‹¤. λ•λ΅λ” μ•λ ¤κ³  ν•΄λ„ μ• μκ°€ μ—†λ‹¤. λ•λ΅λ” λ” μ΄μƒ λ‚΄λ‹¤λ³΄μ§€ μ•κΈ°λ΅ κ²°μ •ν•λ‹¤.   

μ°λ¦¬κ°€ λ°”λΌλ” μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ©΄ μ°λ¦¬κ°€ μΈν„°νμ΄μ¤λ¥Ό μ „μ μΌλ΅ ν†µμ ν•λ‹¤λ” μ¥μ μ΄ μƒκΈ΄λ‹¤. λν• μ½”λ“ κ°€λ…μ„±λ„ λ†’μ•„μ§€κ³  μ½”λ“ μλ„λ„ λ¶„λ…ν•΄μ§„λ‹¤. μ΄μ™€ κ°™μ€ μ„¤κ³„λ” ν…μ¤νΈλ„ μ•„μ£Ό νΈν•λ‹¤. μ μ ν• `Fake` ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ©΄ ν•΄λ‹Ή ν΄λμ¤λ¥Ό ν…μ¤νΈν•  μ μλ‹¤. API μΈν„°νμ΄μ¤κ°€ λ‚μ¨ λ‹¤μ κ²½κ³„ ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό μƒμ„±ν•΄ μ°λ¦¬κ°€ APIλ¥Ό μ¬λ°”λ¥΄κ² μ‚¬μ©ν•λ”μ§€ ν…μ¤νΈν•  μλ„ μλ‹¤.

## πƒ κΉ¨λ—ν• κ²½κ³„
κ²½κ³„μ—μ„λ” ν¥λ―Έλ΅μ΄ μΌμ΄ λ§μ΄ λ²μ–΄μ§„λ‹¤. λ³€κ²½μ΄ λ€ν‘μ μΈ μλ‹¤. μ†ν”„νΈμ›¨μ–΄ μ„¤κ³„κ°€ μ°μν•λ‹¤λ©΄ λ³€κ²½ν•λ”λ° λ§μ€ ν¬μμ™€ μ¬μ‘μ—…μ΄ ν•„μ”ν•μ§€ μ•λ‹¤. μ—„μ²­λ‚ μ‹κ°„κ³Ό λ…Έλ ¥κ³Ό μ¬μ‘μ—…μ„ μ”κµ¬ν•μ§€ μ•λ”λ‹¤. ν†µμ ν•μ§€ λ»ν•λ” μ½”λ“λ¥Ό μ‚¬μ©ν•  λ•λ” λ„λ¬΄ λ§μ€ ν¬μλ¥Ό ν•κ±°λ‚ ν–¥ν›„ λ³€κ²½ λΉ„μ©μ΄ μλ‚μΉκ² μ»¤μ§€μ§€ μ•λ„λ΅ κ°λ³„ν μ£Όμν•΄μ•Ό ν•λ‹¤.   

κ²½κ³„μ— μ„μΉν•λ” μ½”λ“λ” κΉ”λ”ν λ¶„λ¦¬ν•λ‹¤. λν• κΈ°λ€μΉλ¥Ό μ •μν•λ” ν…μ¤νΈ μΌ€μ΄μ¤λ„ μ‘μ„±ν•λ‹¤. μ΄μ½ μ½”λ“μ—μ„ μ™Έλ¶€ ν¨ν‚¤μ§€λ¥Ό μ„Έμ„Έν•κ² μ•μ•„μ•Ό ν•  ν•„μ”κ°€ μ—†λ‹¤. ν†µμ κ°€ λ¶κ°€λ¥ν• μ™Έλ¶€ ν¨ν‚¤μ§€μ— μμ΅΄ν•λ” λ€μ‹  ν†µμ κ°€ κ°€λ¥ν• μ°λ¦¬ μ½”λ“μ— μμ΅΄ν•λ” νΈμ΄ ν›¨μ”¬ λ” μΆ‹λ‹¤. μμΉ«ν•λ©΄ μ¤νλ ¤ μ™Έλ¶€ μ½”λ“μ— νλ‘λ¦¬κ³  λ§λ‹¤.   

μ™Έλ¶€ ν¨ν‚¤μ§€λ¥Ό νΈμ¶ν•λ” μ½”λ“λ¥Ό κ°€λ¥ν• μ¤„μ—¬ κ²½κ³„λ¥Ό κ΄€λ¦¬ν•μ. `Map`μ—μ„ λ΄¤λ“―μ΄, μƒλ΅μ΄ ν΄λμ¤λ΅ κ²½κ³„λ¥Ό κ°μ‹Έκ±°λ‚ μ•„λ‹λ©΄ `ADAPTER` ν¨ν„΄μ„ μ‚¬μ©ν•΄ μ°λ¦¬κ°€ μ›ν•λ” μΈν„°νμ΄μ¤λ¥Ό ν¨ν‚¤μ§€κ°€ μ κ³µν•λ” μΈν„°νμ΄μ¤λ΅ λ³€ν™ν•μ. μ–΄λ λ°©λ²•μ΄λ“  μ½”λ“ κ°€λ…μ„±μ΄ λ†’μ•„μ§€λ©°, κ²½κ³„ μΈν„°νμ΄μ¤λ¥Ό μ‚¬μ©ν•λ” μΌκ΄€μ„±λ„ λ†’μ•„μ§€λ©°, μ™Έλ¶€ ν¨ν‚¤μ§€κ°€ λ³€ν–μ„ λ• λ³€κ²½ν•  μ½”λ“λ„ μ¤„μ–΄λ“ λ‹¤.
